Index: ext/openssl/ossl_x509name.c
--- ext/openssl/ossl_x509name.c.orig
+++ ext/openssl/ossl_x509name.c
@@ -375,7 +375,7 @@ ossl_x509name_to_a(VALUE self)
 	    vname = rb_str_new2(short_name); /*do not free*/
 	}
 	value = X509_NAME_ENTRY_get_data(entry);
-	ary = rb_ary_new3(3, vname, asn1str_to_str(value), INT2NUM(value->type));
+	ary = rb_ary_new3(3, vname, asn1str_to_str(value), INT2NUM(ASN1_STRING_type(value)));
 	rb_ary_push(ret, ary);
     }
     return ret;
