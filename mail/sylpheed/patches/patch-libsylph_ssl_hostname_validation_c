Index: libsylph/ssl_hostname_validation.c
--- libsylph/ssl_hostname_validation.c.orig
+++ libsylph/ssl_hostname_validation.c
@@ -167,7 +167,7 @@ static SSLHostnameValidationResult matches_common_name
 	int common_name_loc = -1;
 	X509_NAME_ENTRY *common_name_entry = NULL;
 	ASN1_STRING *common_name_asn1 = NULL;
-	char *common_name_str = NULL;
+	const char *common_name_str = NULL;
 
 	// Find the position of the CN field in the Subject field of the certificate
 	common_name_loc = X509_NAME_get_index_by_NID(X509_get_subject_name((X509 *) server_cert), NID_commonName, -1);
@@ -186,7 +186,7 @@ static SSLHostnameValidationResult matches_common_name
 	if (common_name_asn1 == NULL) {
 		return SSL_HOSTNAME_ERROR;
 	}			
-	common_name_str = (char *) ASN1_STRING_data(common_name_asn1);
+	common_name_str = (const char *) ASN1_STRING_get0_data(common_name_asn1);
 
 	debug_print("matches_common_name: %s\n", common_name_str);
 
@@ -227,7 +227,7 @@ static SSLHostnameValidationResult matches_subject_alt
 
 		if (current_name->type == GEN_DNS) {
 			// Current name is a DNS name, let's check it
-			char *dns_name = (char *) ASN1_STRING_data(current_name->d.dNSName);
+			const char *dns_name = (const char *) ASN1_STRING_get0_data(current_name->d.dNSName);
 
 			debug_print("matches_subject_alternative_name: %s\n", dns_name);
 
