Index: ssh-pkcs11.c
--- ssh-pkcs11.c.orig
+++ ssh-pkcs11.c
@@ -775,8 +775,8 @@ pkcs11_fetch_ecdsa_pubkey(struct pkcs11_provider *p, C
 		ossl_error("d2i_ASN1_OCTET_STRING failed");
 		goto fail;
 	}
-	attrp = octet->data;
-	if (o2i_ECPublicKey(&ec, &attrp, octet->length) == NULL) {
+	attrp = ASN1_STRING_get0_data(octet);
+	if (o2i_ECPublicKey(&ec, &attrp, ASN1_STRING_lenth(octet)) == NULL) {
 		ossl_error("o2i_ECPublicKey failed");
 		goto fail;
 	}
